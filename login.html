<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="./css/style.css" rel="stylesheet" type="text/css" />
    <link href="./css/sign-up.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="css/sign-up.css">
    <link rel="icon" type="image/png" sizes="16x16" href="./img/ticketmaster-favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./img/ticketmaster-favicon-32x32.png">
    <title>Login</title>
</head>
<body>
    
    <div class="card rounded-1 ps-0">
        <div class="row g-0 no-flex">
          <div class="col-md-5 m-0 position-relative hide">
            <img src="./img/left-panel-image.png" class="img-fluid rounded-start-1" alt="Welcome back to ticket master">
            <div class="px-3">
                <div class="ltcontent position-absolute top-0 p-3">
                    <div class="py-3">
                        <h1 class="htext">Welcome Back</h1>
                    </div>
                    <div class="py-3">
                        <p class="text-white btext">
                            Discover millions of events, get alerts about your favorite artists, teams, plays and more â€” plus always- secure, effortless ticketing.
                        </p>
                    </div>                        
                </div>
                <div class="position-absolute bottom-40 left-300">
                    <div class="">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#fff" width="15" height="28" viewBox="0 0 21 40" class="injected-svg" data-src="/assets/ticketmaster-logo-white-small.bb30b12d.svg">
                            <defs><path id="a-1" d="M289.209 633.998h5.458l1.3-6.226 8.128-2.772-1.854 8.998H309l-1.18 5.764h-6.781l-2.756 13.242a12.75 12.75 0 00-.339 2.949c0 1.822 1.186 2.936 2.886 2.936 1.344 0 2.704-.297 3.657-.69l-1.289 6.096c-1.31.306-2.773.705-4.068.705-5.128 0-8.748-2.09-8.748-7.932 0-2.349.456-4.644.96-7.057l2.145-10.249H288l1.209-5.764z"></path></defs>
                            <use fill-rule="evenodd" transform="translate(-288 -625)" xlink:href="#a-1"></use>
                        </svg>
                    </div>
                </div>
            </div>
          </div>
          <div class="col-md-7 px-3 display">
            <div class="card-body">
              <div class="py-4">
                <h5 class="card-title text-bold">Sign In</h5>
                <p class="card-text">
                    New to Ticketmaster?  
                    <a href="sign_up.html" class="nodecor">Sign Up</a>
                </p>                          
              </div>
              <div class="mt-3">
                <form>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email address</label>
                        <input 
                        type="email" 
                        class="form-control in-border" 
                        name="email" 
                        placeholder="Enter email" 
                        id="email" required>
                    </div>
    
                    <div class="mb-3">
                        <label for="password" class="form-label">Password</label>
                        <input 
                        type="password" 
                        class="form-control in-border" 
                        name="password"   
                        id="password" required>
                    </div>
    
                    <div class="mt-4 d-flex justify-content-between">
                        <div class="d-flex">
                            <input type="checkbox" class="checkbox wh5 in-border">
                            <p class="ms-1 small">Remember Me</p>
                        </div>
                        <div>
                            <a href="" class="nodecor small">Forgot Password?</a>
                        </div>
                    </div>
                    <div class="mt-3 d-flex flex-column">
                        <div>
                            <p class="ptext">
                                By continuing past this page, you agree to the <a href="" class="t-ctext">Terms of Use</a>
                                 and understand that information will be used as described in our <a href="" class="t-ctext">Privacy Policy</a>.
                            </p>
                        </div>
                        
                        <div class="mt-3 align-self-end ws-100">
                            <button
                            class="btn"
                            id="submit-button"
                            >Sign In</button>
                            
                        </div>
                    </div>
                </form>
              </div>                                 
            </div>
          </div>
        </div>
    </div>

    <script src="./js/js/allHelpers.js"></script>
    <script>
        const email = document.getElementById("email");
        const password = document.getElementById("password");
        const submitButton = document.getElementById("submit-button");

        submitButton.addEventListener("click", async function(e) {
            e.preventDefault();

            const response = await helpers.post(auth.login, {
                email: email.value,
                password: password.value
            }, false);


            console.log(response);
        if(response.status == 404) {
            alert("No user found");
        } else if(response.status == 400) {
            alert("Password is incorrect");
        } else if(response.status == 200) {
            console.log(response.data);
            localStorage.setItem("accesstoken", response.data.token);
            localStorage.setItem("role", response.data.role);
            location.assign("/dashboard.html");
        } else {
            alert("Error!");
        }

        });

    </script>

</body>
</html>